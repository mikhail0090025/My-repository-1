define(["OK/UserClientCache"],function(b){var i={};function g(j){j.forEach(function(k){i[k.ui]&&i[k.ui].forEach(function(l){l.updateStatus(k);});});}function d(j){j.forEach(function(k){i[k.ui]&&i[k.ui].forEach(function(l){l.updateStatus(k);});});}function e(j){(j||[]).forEach(function(k){i[k]&&i[k].forEach(function(l){l.updateStatus({online:0});});});}b.listen(g,d,e);var h="ic-online";var c="__mob";var a="__ok-messenger";function f(j,k){this.element=k;this.id=parseInt(k.getAttribute("data-id"),10);this.onlineStatus=parseInt(k.getAttribute("data-st"),10);}f.prototype={activate:function(){b.add(this.id,this.onlineStatus);if(!i[this.id]){i[this.id]=[];}i[this.id].push(this);},deactivate:function(){var j=i[this.id].splice(i[this.id].indexOf(this),1);if(j.length===0){delete i[this.id];}b.remove(this.id);},updateStatus:function(k){var m=k.online===1;var l=k.online===4;var j=k.online===5;this.element.classList.toggle(h,m||l||j);this.element.classList.toggle(c,l);this.element.classList.toggle(a,j);}};return f;});