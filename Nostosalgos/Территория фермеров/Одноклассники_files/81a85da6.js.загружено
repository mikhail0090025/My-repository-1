define(["OK/utils/dom"],function(c){var a="toolbar_dropdown_w_hover";function b(){}b.prototype.closeDropdown=function(){window.setTimeout(function(){this.element.classList.remove(a);document.removeEventListener("mousedown",this.boundDocumentClick,false);}.bind(this),this.closeTimeout);};b.prototype.documentClick=function(d){var f=false;if(this.element.contains(d.target)){if(c.parent(d.target,"u-menu_a",this.element,true)){f=true;}}else{f=true;}if(f){this.closeDropdown();}};b.prototype.cardClick=function(){if(this.element.classList.contains(a)){this.closeDropdown();}else{this.element.classList.add(a);document.addEventListener("mousedown",this.boundDocumentClick,false);}if(!this.isBubbleHidden){this.isBubbleHidden=true;window.navigateOnUrlFromJS(this.closeBubbleHandle);}};b.prototype.mouseEnterHandler=function(){window.clearTimeout(this.timeoutHandle);};b.prototype.mouseLeaveHandler=function(){window.clearTimeout(this.timeoutHandle);this.timeoutHandle=window.setTimeout(this.boundCloseDropdown,700);};b.prototype.activate=function(d){this.element=d;this.closeTimeout=parseInt(this.element.getAttribute("data-timeout"),10);this.card=c.firstByClass(this.element,"js-toolbar-menu");this.timeoutHandle=null;this.dropdown=c.firstByClass(this.element,"toolbar_dropdown");this.closeBubbleHandle=this.element.getAttribute("data-hide-dropdown");this.isBubbleHidden=!this.closeBubbleHandle;this.boundDocumentClick=this.documentClick.bind(this);this.boundCardClick=this.cardClick.bind(this);this.boundCloseDropdown=this.closeDropdown.bind(this);this.boundMouseEnter=this.mouseEnterHandler.bind(this);this.boundMouseLeave=this.mouseLeaveHandler.bind(this);this.card.addEventListener("click",this.boundCardClick,false);this.element.addEventListener("mouseenter",this.boundMouseEnter,false);this.element.addEventListener("mouseleave",this.boundMouseLeave,false);};b.prototype.deactivate=function(){this.card.removeEventListener("click",this.boundCardClick);document.removeEventListener("mousedown",this.boundDocumentClick);this.element.removeEventListener("mouseenter",this.boundMouseEnter);this.element.removeEventListener("mouseleave",this.boundMouseLeave);};return new b();});