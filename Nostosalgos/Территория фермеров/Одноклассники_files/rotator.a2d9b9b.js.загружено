var BannerSet=function(){function t(t,e){this._roll=t,this._banners=e}return t.prototype.chooseBanner=function(){for(var t,e=Math.random()*this._roll,n=0,i=0;!t&&i<this._banners.length;i++){var o=this._banners[i];e>=n&&e<n+o.weight&&(t=o),n+=o.weight}if(!t)throw new Error("Failed to choose banner.");return t},t}(),BannerRotator=function(){function t(t){this._params=t,this._stage=new createjs.Stage("rotatorCanvas"),this._onConfigLoaded=this._onConfigLoaded.bind(this),this._updateStage=this._updateStage.bind(this),this._onOver=this._onOver.bind(this),this._onOut=this._onOut.bind(this),this._onClick=this._onClick.bind(this)}return t.prototype.init=function(){var t=this._params.configURL;Utils.loadJSON(t,this._onConfigLoaded)},t.prototype._onConfigLoaded=function(t){var e=new RotatorConfig(t),n=new RotatorView(e);n.addEventListener("update",this._updateStage),n.addEventListener("rollover",this._onOver),n.addEventListener("rollout",this._onOut),n.addEventListener("click",this._onClick),n.rotate(),this._view=n,this._stage.enableMouseOver(15),this._stage.addChild(n)},t.prototype._onOver=function(){this._stage.cursor="pointer"},t.prototype._onOut=function(){this._stage.cursor=null},t.prototype._onClick=function(){this._view.currentBanner.click()},t.prototype._updateStage=function(){this._stage.update()},t}(),BannerView=function(){function t(t,i,o,r,a,s){this._imageURL=t,this._gameCode=a,this._verticaKey=s,this._link=o,this._id=r,this._bitmap=new createjs.Bitmap(this._imageURL),this.weight=parseInt(i),this.Container_constructor(),this.addChild(this._bitmap),this.on("added",n),this._bitmap.image.onload=e.bind(this)}createjs.extend(t,createjs.Container),t.prototype.click=function(){Utils.sendStat(this._id,this._gameCode,this._verticaKey,"bottom");var t=Parameters.instance.linkTarget;window.open(this._link,t)};var e=function(){this.dispatchEvent(new createjs.Event("update",!0))},n=function(t){Utils.sendStat(this._id,this._gameCode,this._verticaKey,"bottom")};return createjs.promote(t,"Container"),t}();Initializer.initHTML5Banner=function(t){document.getElementById("rotatorCanvas").style.display="block";var e=new BannerRotator(t);e.init(t)};var RotatorConfig=function(){function t(t){this.rotationTime=t.rotation_time,this.staticURL=t.static_url,this.set=new BannerSet(t.set.roll,this._getBanners(t.set,this.staticURL))}return t.prototype._getBanners=function(t,e){return t.banners.map(function(t){return new BannerView(e+t.image,t.weight,t.link,t.id,t.code,t.vertica_key)},this)},t}(),RotatorView=function(){function t(t){this._config=t,this.currentBanner=null,this.Container_constructor(),this.rotate=this.rotate.bind(this);var e=new createjs.Shape;e.graphics.beginFill("0xFF0000").drawRect(0,0,760,90),this.hitArea=e}return createjs.extend(t,createjs.Container),t.prototype.rotate=function(){var t=this._config.set.chooseBanner();t!=this.currentBanner&&(this.currentBanner&&this.removeChild(this.currentBanner),this.addChild(t),this.currentBanner=t,this.dispatchEvent(new createjs.Event("update",!0))),setTimeout(this.rotate,this._config.rotationTime)},createjs.promote(t,"Container"),t}();
//# sourceMappingURL=rotator.js.map